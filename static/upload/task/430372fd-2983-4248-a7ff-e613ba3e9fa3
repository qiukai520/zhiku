drop TABLE if exists `task`;
create TABLE `task`(
`tid` int(11) primary key, 
`title` varchar(512) NOT NUll  COMMENT '任务名称',
`content` text NOT NULL COMMENT '任务描述', 
`type_id` smallint NOT NULL COMMENT ' 任务类型',
`issuer_id` int(11) NOT NULL  COMMENT '发布人',
`attribute` tinyint(1) NOT NUll COMMENT '任务属性：0绩效;1临时;2紧急;',
`execute_way` tinyint(1) DEFAULT '0' COMMENT'0代表并行执行，1次序执行',
`teamwork_auth` tinyint(1) DEFAULT '0' COMMENT '0代表相互可见；1互不可见；2指定可见',
`auditor_id` int(11) NOt NULL COMMENT '审核人' ,
`tcid`  int(11) COMMENT '任务周期类型',
`start_time` datetime NOT NULL COMMENT '起止日期',
`deadline` datetime NOT NULL COMMENT '终止期限',
`status` tinyint(1) DEFAULT '1' COMMENT'1启动,2暂停,4终止',
`create_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
`last_edit` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '最后编辑时间'
)ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='任务表';


drop TABLE if exists `task_type`;
create TABLE `task_type`(
`tpid` int(11) primary key,
`name` varchar(32) NOT NULL COMMENT '名称'
)ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='任务附件总表';

drop TABLE if exists `task_attachment`;
create TABLE `task_attachment`(
`tamid` int(11) primary key,
`tid` int(11) NOT NULL  COMMENT '任务ID',
`attachment` varchar(512) COMMENT '附件',
`description` varchar(512) COMMENT '附件描述'
)ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='任务附件总表';


drop TABLE if exists `staff`;
create TABLE `staff`(
`sid` int(11) primary key, 
`name` varchar(64) NOT NUll
)ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='员工表';

drop TABLE if exists `task_tag`;
create TABLE `task_tag`(
`ttid` int(11) NOT NULL primary key,
`tid` int(11) NOT NULL  COMMENT '任务id',
`name` varchar(32) COMMENT '标签名称'
)ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='任务标签表';

drop TABLE if exists `task_cycle`;
create TABLE `task_cycle`(
`tcid` int(11) NOT NULL  primary key,
`name` varchar(32)  
)ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='任务周期表';


drop TABLE if exists `task_assign`;
create TABLE `task_assign`(
`tasid`int(11) NOT NULL primary key,
`tid` int(11) NOT NULL COMMENT'任务ID',
`member_id` int(11) NOT NULL COMMENT' 员工ID',
`content` text NOT NULL COMMENT '任务描述',
`deadline` datetime NOT NULL COMMENT '最后期限',
`weight` smallint(5)  NOT NULL DEFAULT '20' COMMENT '权重:0-100',
`create_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
`last_edit` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '最后编辑时间'
)ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='任务分配表';


drop TABLE if exists `task_assign_attachment`;
create TABLE `task_assign_attachment`(
`taaid` int(11) primary key,
`tid` int(11) NOT NULL  COMMENT '任务ID',
`sid` int(11) NOT NULL  COMMENT '员工ID',
`attachment` varchar(512) COMMENT '附件',
`description` varchar(512) COMMENT '附件描述'
)ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='任务附件分配表';


drop TABLE if exists `task_auth`;
create TABLE `task_auth`(
`taid` int(11) NOT NUll primary key,
`tmid` int(11) NOT NUll  COMMENT '任务分配ID',
`status` tinyint(1) NOT NULL COMMENT '审核状态：0 未审核，1已审核',
`result` tinyint(1) NOT NULL COMMENT '审核状态：0 通过，1未通过',
`score` tinyint(1) NOT NULL COMMENT '评分：1及格；2一般；3出色；4优秀；5经验被录取到知识库',
`create_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
`last_edit` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '最后编辑时间'
)ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='任务审核表';


drop TABLE if exists `task_reject_record`;
create TABLE `task_reject_record`(
`trid` int(11) NOT NULL primary key,
`tmid` int(11) NOT NULL COMMENT '任务分配ID',
`create_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
`reason` text COMMENT '原因'
)ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='任务驳回记录表';


drop TABLE if exists `task_submit_record`;
create TABLE `task_submit_record`(
`tsid` int(11)  primary key,
`tmid` int(11) NOT NULL COMMENT '任务分配ID',
`title` varchar(512) COMMENT '标题',
`summary` varchar(512) COMMENT '备注',
`experience` varchar(512) COMMENT '心得',
`create_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
`last_edit` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '最后编辑时间'
)ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='任务提交记录表';


drop TABLE if exists `task_submit_attachment`;
create TABLE `task_submit_attachment`(
`tsaid` int(11) primary key,
`tsid`  int(11) NOT NULL COMMENT '任务提交ID',
`attachment` varchar(512) COMMENT '附件',
`description` varchar(512) COMMENT '附件描述'
)ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='任务提交附件表';


