{% extends "layout.html" %}
{% load  admin_tags %}

{% block css  %}
    <style>
       td, th{
            text-align: left;
            vert-align: middle;
            padding: 10px 18px !important;
        }
        .form-horizontal .control-label {
            padding-top: 7px;
            margin-bottom: 0;
            text-align: right;
        }
     </style>
{% endblock %}
{% block conent %}
    <div class="panel panel-default">
  <!-- Default panel contents -->
  <div class="panel-heading">我的任务</div>
  <div class="panel-body" style="background-color:#f2f2f2">
      <form class="form-inline left"  action="{% url "personal_task_list" %}" method="get">
          <div class="form-group"> <label for="book_sort">类别</label>
              <select id="book_sort" name="s"   class="form-control">
                    <option value=0>所有</option>
                  {% build_task_type_filter  query_sets.0.tid %}
              </select>
          </div>

          <button type="submit" class="btn btn-default">搜索</button>
    </form>
  </div>
        <!-- Table -->
    <table class="table datatable table-striped table-hover table-striped">
      <thead>
      <tr >
          <th><input type="checkbox" onclick="SelectAll(this)"></th>
          <th>ID</th>
          <th>任务名称</th>
          <th>任务描述</th>
          <th>任务类别</th>
          <th>完成状态</th>
          <th>创建时间</th>
          <th>截止时间</th>
          <th>操作</th>
      </tr>
      </thead>
      <tbody>
      {% for obj in  query_sets%}
          {% query_task_by_tid obj.tid as task_obj %}
          {% if obj.title %}
               <tr>
                  <td><input type="checkbox"></td>
                  <td>{{ obj.tid }}</td>
                  <td>{{ obj.title }}</td>
                  <td>{{ obj.content|slice:"20"}}</td>
                  <td>{% change_to_task_type  task_obj.type_id  %}</td>
        {#          <td>{% change_to_staff obj.issuer_id %}</td>#}
        {#          <td>{% change_to_task_assign_status  obj.is_assign%}</td>#}
        {#          <td>{% change_to_task_status obj.status %} </td>#}
                  <td>{% change_to_task_finish_status obj.is_finish%}</td>
                  <td>{{ obj.deadline |date:"Y-m-d "}}</td>
                  <td>{{ obj.create_time|date:"Y-m-d H:i" }}</td>
                    <td>
                         {% if obj.is_finish %}
                            <a  href="{%url "complete_task" %}?tasid={{ obj.tasid }}" class="btn btn-primary" >查看</a>
                        {% else %}
                            <a  href="{%url "complete_task" %}?tasid={{ obj.tasid }}" class="btn btn-primary" >继续完成</a>
                        {% endif %}
                  </td>
              </tr>
          {% else %}
                <tr>
                  <td><input type="checkbox"></td>
                  <td>{{ obj.tid }}</td>
                  <td>{{ task_obj.title }}</td>
                  <td>{{ task_obj.content|slice:"20"}}</td>
                  <td>{% change_to_task_type  task_obj.type_id  %}</td>
        {#          <td>{% change_to_staff obj.issuer_id %}</td>#}
        {#          <td>{% change_to_task_assign_status  obj.is_assign%}</td>#}
        {#          <td>{% change_to_task_status obj.status %} </td>#}
                  <td>{% change_to_task_finish_status obj.is_finish%}</td>
                  <td>{{ task_obj.deadline |date:"Y-m-d "}}</td>
                  <td>{{ task_obj.create_time|date:"Y-m-d " }}</td>
                    <td>
                        {% if obj.is_finish %}
                            <a  href="{%url "complete_task" %}?tasid={{ obj.tasid }}" class="btn btn-primary" >查看</a>
                        {% else %}
                            <a  href="{%url "complete_task" %}?tasid={{ obj.tasid }}" class="btn btn-primary" >继续完善</a>
                        {% endif %}
                  </td>
              </tr>
          {% endif %}
      {% endfor %}
      </tbody>
  </table>
    </div>
{% endblock %}
{% block js %}
{% endblock%}