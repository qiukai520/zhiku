{% extends "layout.html" %}
{% load  admin_tags %}

{% block css  %}
    <style>
       td, th{
            text-align: left;
            vert-align: middle;
            padding: 10px 18px !important;
        }
        .form-horizontal .control-label {
            padding-top: 7px;
            margin-bottom: 0;
            text-align: right;
        }
     </style>
{% endblock %}
{% block conent %}
    <div class="panel panel-default">
  <!-- Default panel contents -->
  <div class="panel-heading">我的任务</div>
  <div class="panel-body" style="background-color:#f2f2f2">
  </div>
        <!-- Table -->
    <table id="table_local" class="table datatable table-striped table-hover table-striped">
      <thead>
      <tr >
          <th><input type="checkbox" onclick="SelectAll(this)"></th>
          <th>ID</th>
          <th>任务名称</th>
          <th>任务描述</th>
          <th>任务类别</th>
          <th>完成状态</th>
          <th>创建时间</th>
          <th>截止时间</th>
          <th>操作</th>
      </tr>
      </thead>
      <tbody>
      {% for obj in  query_sets%}
          {% query_task_by_tid obj.tid as task_obj %}
          {% if obj.title %}
               <tr>
                  <td><input type="checkbox"></td>
                  <td>{{ obj.tid }}</td>
                  <td>{{ obj.title }}</td>
                  <td>{{ obj.content|slice:"20"}}</td>
                  <td>{% change_to_task_type  task_obj.type_id  %}</td>
        {#          <td>{% change_to_staff obj.issuer_id %}</td>#}
        {#          <td>{% change_to_task_assign_status  obj.is_assign%}</td>#}
        {#          <td>{% change_to_task_status obj.status %} </td>#}
                  <td>{% change_to_task_finish_status obj.is_finish%}</td>
                  <td>{{ obj.deadline |date:"Y-m-d "}}</td>
                  <td>{{ obj.create_time|date:"Y-m-d H:i" }}</td>
                    <td>
                         {% if obj.is_finish %}
                            <a  href="{%url "complete_task" %}?tasid={{ obj.tasid }}" class="btn btn-primary" >查看</a>
                        {% else %}
                            <a  href="{%url "complete_task" %}?tasid={{ obj.tasid }}" class="btn btn-primary" >继续完成</a>
                        {% endif %}
                  </td>
              </tr>
          {% else %}
                <tr>
                  <td><input type="checkbox"></td>
                  <td>{{ obj.tid }}</td>
                  <td>{{ task_obj.title }}</td>
                  <td>{{ task_obj.content|slice:"20"}}</td>
                  <td>{% change_to_task_type  task_obj.type_id  %}</td>
        {#          <td>{% change_to_staff obj.issuer_id %}</td>#}
        {#          <td>{% change_to_task_assign_status  obj.is_assign%}</td>#}
        {#          <td>{% change_to_task_status obj.status %} </td>#}
                  <td>{% change_to_task_finish_status obj.is_finish%}</td>
                  <td>{{ task_obj.deadline |date:"Y-m-d "}}</td>
                  <td>{{ task_obj.create_time|date:"Y-m-d " }}</td>
                    <td>
                        {% if obj.is_finish %}
                            <a  href="{%url "complete_task" %}?tasid={{ obj.tasid }}" class="btn btn-primary" >查看</a>
                        {% else %}
                            <a  href="{%url "complete_task" %}?tasid={{ obj.tasid }}" class="btn btn-primary" >继续完善</a>
                        {% endif %}
                  </td>
              </tr>
          {% endif %}
      {% endfor %}
      </tbody>
  </table>
    </div>
{% endblock %}
{% block js %}
    <script>
      /*
    自执行函数
    */
    $(function () {
         //初始化datatables 改成中文显示
       $('#table_local').dataTable({
           bDestroy: true,
           autoWidth:false,////不开启自动宽度，用bootstrap的自适应去调整
           "lengthMenu": [10,20,30, 40,50],//表格行数选择框内数目 显示2条,4条,20条,50条
           "displayLength": 10,//默认的显示行数 (也就是每页显示几条数据)
           "language": {//自定义语言提示
                "processing": "处理中...",
                "lengthMenu": "显示 _MENU_ 项结果",
                "zeroRecords": "没有找到相应的结果",
                "info": "第 _START_ 至 _END_ 行，共 _TOTAL_ 行",
                "infoEmpty": "第 0 至 0 项结果，共 0 项",
                "infoFiltered": "(由 _MAX_ 项结果过滤)",
                "infoPostFix": "",
                "search": "搜索:",
                "searchPlaceholder": "请输入要搜索内容...",
                "url": "",
                "thousands": "'",
                "emptyTable": "表中数据为空",
                "loadingRecords": "载入中...",
                "infoThousands": ",",
                "paginate": {
                    "first": "首页",
                    "previous": "上页",
                    "next": "下页",
                    "last": "末页"
                }
            }
	});
    });

    </script>
{% endblock%}